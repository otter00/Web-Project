var json = `[{
    "name": "Walt Disney",
    "universe": "Animation Studio",
    "founded": "October 16, 1923",
    "founders": "Walt Disney & Roy O. Disney",
    "products": "Animated films & Animated series",
    "website": "disneyanimation.com",
    "url": "https://upload.wikimedia.org/wikipedia/ru/thumb/c/c8/Walt_Disney_Animation_Studios_logo.svg/1200px-Walt_Disney_Animation_Studios_logo.svg.png",
    "info": "Walt Disney Animation Studios, sometimes shortened to Disney Animation, is an American animation studio that creates animated features and short films for The Walt Disney Company. The studio's current production logo features a scene from its first synchronized sound cartoon, Steamboat Willie (1928). Founded on October 16, 1923, by brothers Walt Disney and Roy O. Disney, it is the oldest-running animation studio in the world."
},{
    "name": "Мельница",
    "universe": "Кинокомпания",
    "founded": "26 марта 1999",
    "founders": "Сергей Сельяновб, Александр Боярский, Константин Бронзит",
    "products": "Мультфильмы и мультсериалы",
    "website": "http://melnitsa.com/",
    "url" : "https://popokanimation.com/wp-content/uploads/2021/07/Melnica-1536x940.png",
    "info": "Студия анимационного кино «Мельница» — российская анимационная студия, выпускающая мультфильмы и мультсериалы. Создана 26 марта 1999 года, учредителями выступили Александр Боярский и кинокомпания СТВ. Расположена в Санкт-Петербурге, на проспекте Большевиков, дом 34, корпус 2. Студия наиболее известна по франшизам «Три богатыря» и «Иван Царевич и Серый Волк»." 
},{
    "name": "Pixar",
    "universe": "Computer animation studio ",
    "founded": "February 3, 1986, Richmond, California",
    "founders": "Edwin Catmull, Alvy Ray Smith",
    "products": "Computer animations",
    "website": "pixar.com",
    "url" : "https://images.squarespace-cdn.com/content/v1/51b3dc8ee4b051b96ceb10de/1496085612187-4CO3KST07WUNLT12VFKF/image-asset.png?format=1500w",
    "info": "Pixar Animation Studios (stylized as P I X A R) is an American computer animation studio known for its critically and commercially successful computer animated feature films. It is based in Emeryville, California, United States. Since 2006, Pixar has been a subsidiary of Walt Disney Studios, which is another studio owned by The Walt Disney Company. <br> Pixar started in 1979 as part of the Lucasfilm computer division, known as the Graphics Group, before its spin-off as a corporation in 1986, with funding from Apple co-founder Steve Jobs, who became its majority shareholder."
},{
    "name": "Союзмультфильм",
    "universe": "Киностудия",
    "founded": "10 июня 1936 года",
    "founders": "Юлиана Слащёва, Борис Машковцев",
    "products": "Мультфильмы",
    "website": "souzmult.ru",
    "url" : "https://sbergraduate.ru/wp-content/uploads/2020/12/Soyuzmultfilm_Logo_Cobranding-01.png",
    "info": "«Союзмультфи́льм» — советская и российская государственная киностудия по производству мультипликационных фильмов. Создана в Москве 10 июня 1936 года и является крупнейшей киностудией анимационных фильмов. За время существования студии создано более полутора тысяч мультфильмов в самых разных жанрах и художественных техниках, многие из которых вошли в «золотой фонд» мировой анимационной классики и получили более четырёхсот международных фестивальных призов и наград. <br> Создана под названием «Союздетмультфильм» вследствие объединения мелких коллективов «Совкино», «Межрабпомфильма» (Частично «Межрабпомфильм» был переделан в Киностудию «Союздетфильм», сейчас — «Киностудия им. Горького») и «Мосфильма». Приказ о создании киностудии мультипликационных фильмов был подписан начальником Главного управления кинофотопромышленности СССР, но считается, что решение о её создании исходило лично от И.В. Сталина."
},{
    "name": "Studio Ghibli",
    "universe": "Animation studio",
    "founded": "June 15, 1985, Tokyo, Japan",
    "founders": "Hayao Miyazaki, Toshio Suzuki, Isao Takahata",
    "products": "Animated feature films, television films, commercials, live-action films",
    "website": "www.ghibli.jp",
    "url" : "https://nerdreactor.com/wp-content/uploads/2014/08/Studio_Ghibli_Logo.jpg",
    "info": "Studio Ghibli, Inc. is a Japanese animation studio based in Koganei, Tokyo. It is best known for its range of animated feature films, and has also produced several short subjects, television commercials, and two television films. Its mascot and most recognizable symbol is a character named Totoro, a giant spirit inspired by raccoon dogs (tanuki) and cats from the 1988 anime film My Neighbor Totoro. "
},{
    "name": "Петербург",
    "universe": "Студия анимации",
    "founded": "31 марта 2003",
    "founders": "Илья Попов, Анатолий Прохоров",
    "products": "Детские мультфильмы",
    "website": "riki-group.ru/work/animation",
    "url" : "https://abali.ru/wp-content/uploads/2017/10/smeshariki-cvet.png",
    "info": "Студия компьютерной анимации «Петербург» — российская анимационная студия, расположенная в Санкт-Петербурге. Наиболее известна производством мультипликационного сериала «Смешарики», за который авторы были удостоены Государственной премии Российской Федерации в области культуры и искусства за 2008 год. В 2016 году права на трансляцию большинства мультсериалов получает ВГТРК."
},{
    "name": "DreamWorks",
    "universe": "Animation studio",
    "founded": "October 12, 1994",
    "founders": "Steven Spielberg, Jeffrey Katzenberg, David Geffen",
    "products": "Television animated series, theatrical animated feature films, theatrical animated short films",
    "website": "dreamworks.com",
    "url" : "https://www.pvsm.ru/images/2016/04/30/kompaniya-Comcast-pokupaet-DreamWorks-Animation-SKG.png",
    "info": "DreamWorks Animation LLC is an American animation studio that produces animated films and television programs and is a subsidiary of Universal Pictures, a division of NBCUniversal, which is itself a division of Comcast. The studio has released 44 feature films as of December 2022, including several of the highest-grossing animated films of all time, with Shrek 2 (2004) having been the highest at the time of its release."
}]`;

var links = `[{
    "link": "https://en.wikipedia.org/wiki/Walt_Disney_Animation_Studios"
},{
    "link": "https://ru.wikipedia.org/wiki/Мельница_(кинокомпания)"
}, {
    "link": "https://en.wikipedia.org/wiki/Pixar"
},{
    "link": "https://ru.wikipedia.org/wiki/Союзмультфильм"
},{
    "link": "https://ru.wikipedia.org/wiki/Studio_Ghibli"
},{
    "link": "https://ru.wikipedia.org/wiki/Петербург_(студия_анимации)"
},{
    "link": "https://en.wikipedia.org/wiki/DreamWorks_Animation"
}]`;

document.addEventListener('DOMContentLoaded', function (e) {
    let cards = JSON.parse(json);
    console.log(cards);

    let hrefs = JSON.parse(links);
    // console.log(hrefs[0].link);
    // console.log(hrefs[5].link);

    let cardsContent = "";
    let counter = 1; //dynamic form id
    let href = 0; //dynamic link

    for(let card of cards) {
    {
        cardsContent += `<div class='gallery__card'>
        <h2 class='card__name'><a class='name__link' href='${hrefs[href].link}'>${card.name}</a></h2>` + 
        `<form id='${counter}' action="#">
        <h3>${card.universe}</h3>
        <span><p class='bold__text'>Founded:</p> ${card.founded}</span> 
        <span><p class='bold__text'>Founders:</p> ${card.founders}</span>
        <span><p class='bold__text'>Products:</p> ${card.products}</span>
        <span><p class='bold__text'>Website:</p> ${card.website}</span> 
        <div class='logo'><img src='${card.url}'></div>
        <p>${card.info}</p>
        </form>

        <div class='labels' id='${counter}'>      
        <label class="container__label" for="">
        <input type="radio" value='1' class="container__input" name="raiting">
            <svg class="icon">
                <use xlink:href="../icons/sprite.svg#star-full-icon"></use>
            </svg>
        </label>

        <label class="container__label" for="">
        <input type="radio" value='2' class="container__input" name="raiting">
            <svg class="icon">
                <use xlink:href="../icons/sprite.svg#star-full-icon"></use>
            </svg>
        </label>

        <label class="container__label" for="">
        <input type="radio" value='3' class="container__input" name="raiting">
            <svg class="icon">
                <use xlink:href="../icons/sprite.svg#star-full-icon"></use>
            </svg>
        </label>

        <label class="container__label" for="">
        <input type="radio" value='4' class="container__input" name="raiting">
            <svg class="icon">
                <use xlink:href="../icons/sprite.svg#star-full-icon"></use>
            </svg>
        </label>

        <label class="container__label" for="">
        <input type="radio" value='5' class="container__input" name="raiting">
            <svg class="icon">
                <use xlink:href="../icons/sprite.svg#star-full-icon"></use>
            </svg>
        </label>
        </div> 

        </div>`;
        counter++; //increment the value
        href++;
    }
}
    //console.log(cardsContent);

    //set cards into document
    document.getElementById('gallery__container').innerHTML = cardsContent;

    // const icons = document.querySelectorAll('.icon');
    // console.log(icons);

    // const inputs = document.querySelectorAll('.container__input')
    // console.log(inputs);
});


const root = document.querySelector('#gallery__container');
console.log(root);

root.addEventListener('click', (event) => {
    if (event.target.classList.contains('container__input')) {
    const form = event.target.parentNode.parentNode;
    const inputs = form.querySelectorAll('.container__input');
    const icons = form.querySelectorAll('.icon');
    const key = form.id;
    const value = event.target.value;

    raitingColor(icons, inputs);

    // console.log(event.target.value);
    localStorage.setItem(key, value);
    }
});

function raitingColor(icons, inputs) {
    icons.forEach((elem) => {
        elem.style = 'fill: black';
    })

    for (let i = 0; i < inputs.length; i++) {
        icons[i].style = 'fill: gold';
        if (inputs[i].checked) {
            break;
        }
    }
}

//fill the stars from localStorage (if it has them for each card)
window.addEventListener('load', (event) => {
    const arrLabels = document.querySelectorAll('.labels');

    arrLabels.forEach((elem) => {
        if (localStorage.getItem(elem.id)) {
            const valueLocalStorage = localStorage.getItem(elem.id); //key: id(value)
            console.log(valueLocalStorage);

            const icons = elem.querySelectorAll('.icon');
            for (let i = 0; i < valueLocalStorage; i++) {
                icons[i].style = 'fill: gold';
            }
        }
    })
})

//get all the keys of object (localstorage is object)
//const allKeys = Object.keys(localStorage);
// for (const key of allKeys) {
//     console.log(key);
//     console.log(localStorage[key]);
// }


function storageCheck() {
if (localStorage.length != 0) {
    const arrKeys = Object.keys(localStorage);
    console.log('in storage we have ' + arrKeys + ' active keys');

    arrKeys.forEach((key) => {
        console.log('here we have ' + key);
        console.log('with value ' + localStorage[key]);
    })

    // const form = document.querySelectorAll('form');
    // console.log(form);

    // for(let fk = 0; fk < arrKeys.length; fk++) {
    //     for(let f = 0; f < form.length; f++) {
    //         if (fk == f) {
    //             console.log('equal');
    //             //console.log(form[f].nextElementSibling.id);
    //             //raitingColor(icons, form[f].nextElementSibling.id);
    //         }
    //     }
    // }  
}
}

//check whether localstorage has objects
document.addEventListener('DOMContentLoaded', ()=> {
    storageCheck();
});